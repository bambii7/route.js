function Route(a,b,c){c=c||{},this.path=a,this.callbacks=b,this.regexp=PathRegexp(a,this.keys=[],c.sensitive,c.strict)}function Router(){this.routes=[]}var PathRegexp=function(a,b,c,d){return"[object RegExp]"==toString.call(a)?a:(Array.isArray(a)&&(a="("+a.join("|")+")"),a=a.concat(d?"":"/?").replace(/\/\(/g,"(?:/").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?(\*)?/g,function(a,c,d,e,f,g,h){return b.push({name:e,optional:!!g}),c=c||"",""+(g?"":c)+"(?:"+(g?c:"")+(d||"")+(f||d&&"([^/.]+?)"||"([^/]+?)")+")"+(g||"")+(h?"(/*)?":"")}).replace(/([\/.])/g,"\\$1").replace(/\*/g,"(.*)"),new RegExp("^"+a+"$",c?"":"i"))};Route.prototype.match=function(a){var b=this.keys,c=this.params=[],d=this.regexp.exec(a);if(!d)return!1;for(var e=1,f=d.length;f>e;++e){var g=b[e-1];try{var h="string"==typeof d[e]?decodeURIComponent(d[e]):d[e]}catch(i){var j=new Error("Failed to decode param '"+d[e]+"'");throw j.status=400,j}g?c[g.name]=h:c.push(h)}return!0},Router.prototype.route=function(a,b){b="function"==typeof b?[b]:b;var c=new Route(a,b);return this.routes.push(c),this},Router.prototype.match=function(a){var b=0,c=this.routes.length,d=void 0;for(b;c>b;b++)if(d=this.routes[b],d.match(a))return d},Router.prototype.dispatch=function(a){var b,c=0,d=this.match(a);if(!d)return!1;for(b=d.callbacks.length,c;b>c;c++)d.callbacks[c].call(d,d.params)};